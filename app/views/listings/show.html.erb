<%= render partial: '/listings/image_carousel'%>

<div class="container">
	<div class="col-lg-7">
		<% unless @listing.user.moderator? %>
			<% if @listing.user == current_user || current_user.admin? %>
				<%= link_to 'Edit Listing', edit_listing_path %>
			<% end %>
		<% end %>
		<% unless current_user.customer? || @listing.verified %>
				<%= link_to 'Verify Listing', verify_listing_path, method: :verify, data: { confirm: 'Are you sure?' }, class: "btn btn-primary" %>
		<% end %> 
		<br>

		<div class="row">
			<span class="listing-title">
				<%= @listing.title %>
			</span>
			<span><%= "verified" if @listing.verified %></span>
		</div>

		<div class="row">
			<div class="listing-tag">
				<span>Tags: </span>
				<span><%= raw @listing.tags.map(&:name).map { |t| link_to t, tag_path(t) }.join(', ') %></span>
			</div>
		</div>
		
		<div class="row">
			<div class="listing-address">
				<%= @listing.address %> 
				<%= @listing.city %> <%= @listing.postcode %>
				<%= @listing.state %> <%= @listing.country %> 
			</div>
		</div>
		
		<div class="row">
			<span>RM</span>
			<span class="listing-price"><%= number_with_precision(@listing.price_per_night, precision: 2) %></span>
			<span> per night</span>
		</div>

		<div class="row">
			<% host = @listing.user %>
			<div class="listing-host"><%= link_to user_path(host) do %><%= host.name %><% end %></div>
		</div>

		<br>
		<% if @listing.user == current_user || current_user.admin? %>
			<%= link_to 'Delete Listing', listing_path(@listing), method: :delete, data: { confirm: 'Are you sure?' } %>
		<% end %>
	</div>

	<div class="col-lg-5">
		<%= form_for @reservation, html: { class: 'form-horizontal reservation-form' } do |form| %>
			<!-- Checkin / checkout date -->
			<div class="row form-group">
				<div class="reservation-col">
					<%= form.label :checkin_date, "Check In", class: 'control-label' %>
					<%= form.text_field :checkin_date, class: 'form-control datetimepicker_in' %>
				</div>
				<div class="reservation-col">
					<%= form.label :checkout_date, "Check Out", class: 'control-label' %>
					<%= form.text_field :checkout_date, class: 'form-control datetimepicker_out' %>
				</div>
			</div>

			<%= form.hidden_field :listing_id, value: @listing.id %>

			<!-- Submit button -->
	    <div class="submit-field form-group">
		      <%= form.submit 'Book', class: 'btn btn-danger' %>
	    </div>
		<% end %>
	</div>
</div>
